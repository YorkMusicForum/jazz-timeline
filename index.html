<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jazz History Timeline | York Music Forum</title>
  <style>
    body {
      font-family: 'Muli', sans-serif;
      background: white;
      color: black;
      margin: 2rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    h1, h2, h3 {
      font-family: 'Abeezee', serif;
      color: #8b1453;
      margin-bottom: 0.3rem;
    }
    #era-image {
      display: block;
      margin: 1rem auto;
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    #decade-buttons {
      text-align: center;
      margin-bottom: 2rem;
    }
    #decade-buttons button {
      background: #8b1453;
      border: none;
      color: white;
      font-family: 'Abeezee', serif;
      font-size: 1rem;
      margin: 0 0.3rem 0.6rem 0.3rem;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #decade-buttons button:hover,
    #decade-buttons button:focus {
      background-color: #5e0d36;
      outline: none;
    }
    #timeline div {
      border-bottom: 1px solid #ddd;
      padding-bottom: 1rem;
      margin-bottom: 1rem;
    }
    #timeline a {
      color: #8b1453;
      text-decoration: none;
    }
    #timeline a:hover {
      text-decoration: underline;
    }
    .donate-button {
      background-color: #8b1453;
      color: white;
      font-family: 'Abeezee', serif;
      font-size: 1.2rem;
      padding: 0.8rem 2rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      display: block;
      margin: 2rem auto 1rem auto;
      transition: background-color 0.3s ease;
      text-align: center;
      max-width: 200px;
    }
    .donate-button:hover,
    .donate-button:focus {
      background-color: #5e0d36;
      outline: none;
    }
  </style>
</head>
<body>

  <!-- Logo -->
  <img src="images/your-logo.png" alt="York Music Forum Logo" style="display:block; margin: 0 auto 1.5rem auto; max-width: 250px;" />

  <h1>Jazz History Timeline</h1>

  <!-- Era Image -->
  <img id="era-image" src="images/1900-1910.jpg" alt="Jazz era" />

  <!-- Timeline Display -->
  <section id="timeline"></section>

  <!-- Decade Selection Buttons -->
  <div id="decade-buttons">
    <button data-decade="1900-1910">1900-1910</button>
    <button data-decade="1910-1920">1910-1920</button>
    <button data-decade="1920-1930">1920-1930</button>
    <button data-decade="1930-1940">1930-1940</button>
    <button data-decade="1940-1950">1940-1950</button>
    <button data-decade="1950-1960">1950-1960</button>
    <button data-decade="1960-1970">1960-1970</button>
    <button data-decade="1970-1980">1970-1980</button>
    <!-- Add more buttons as needed -->
  </div>

  <!-- Donate Button -->
  <button class="donate-button" onclick="window.open('https://your-donate-link.com', '_blank')">Donate to YMF</button>

  <script>
    // Fetch CSV file and parse it into an array of objects
    async function fetchCSV(url) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error('Failed to fetch ' + url);
      }
      const text = await response.text();
      return parseCSV(text);
    }

    // Basic CSV parser: assumes first line is headers, comma separated
    function parseCSV(text) {
      const lines = text.trim().split('\n');
      const headers = lines[0].split(',').map(h => h.trim());
      return lines.slice(1).map(line => {
        const values = line.split(',').map(v => v.trim());
        let obj = {};
        headers.forEach((header, i) => obj[header] = values[i]);
        return obj;
      });
    }

    // Display timeline events in the timeline section
    function displayTimeline(events) {
      const timelineDiv = document.getElementById('timeline');
      timelineDiv.innerHTML = '';  // Clear previous events

      if (events.length === 0) {
        timelineDiv.innerHTML = '<p>No events found for this decade.</p>';
        return;
      }

      events.forEach(event => {
        const eventDiv = document.createElement('div');
        eventDiv.style.marginBottom = '1.5rem';

        eventDiv.innerHTML = `
          <h3>${event.Year}: ${event.Event}</h3>
          <p>${event.Description}</p>
          ${event.SpotifyLink ? `<p><a href="${event.SpotifyLink}" target="_blank" rel="noopener noreferrer">Listen on Spotify</a></p>` : ''}
        `;
        timelineDiv.appendChild(eventDiv);
      });
    }

    // Update the era image for the selected decade
    function updateEraImage(decade) {
      const eraImage = document.getElementById('era-image');
      eraImage.src = `images/${decade}.jpg`;
      eraImage.alt = `Jazz era: ${decade}`;
    }

    // Load decade data and update page
    async function loadDecade(decade) {
      try {
        const events = await fetchCSV(`data/${decade}.csv`);
        displayTimeline(events);
        updateEraImage(decade);
      } catch (error) {
        const timelineDiv = document.getElementById('timeline');
        timelineDiv.innerHTML = `<p style="color:red;">Error loading data: ${error.message}</p>`;
      }
    }

    // Add click event listeners to decade buttons
    document.getElementById('decade-buttons').addEventListener('click', (event) => {
      if (event.target.tagName === 'BUTTON') {
        const decade = event.target.getAttribute('data-decade');
        loadDecade(decade);
      }
    });

    // Load the first decade automatically on page load
    window.addEventListener('load', () => {
      loadDecade('1900-1910');
    });
  </script>

</body>
</html>
